/*! uzai - v0.1.11 - 2016 */
/*!
 * jsonchou 筛选
 * v: 1.1
 * d: 2014-3-6
*/
!function(a){a.fn.uzSorter=function(b){var c=a.extend({},a.fn.uzSorter.option,b),d=function(a){for(var b=[],c={},d=0;d<a.length;d++)c[a[d]]||(b.push(a[d]),c[a[d]]=1);return b},e=function(a,b){for(var c=0,d=0,e=[];c<a.length&&d<b.length;)a[c]<b[d]?c++:a[c]>b[d]?d++:(e.push(a[c]),c++,d++);return e},f=function(a,b){return a-b};return this.each(function(b,g){var h=a(this),i=h.attr("id")+"_copy",j=h.attr("id")+"_null",k=h.attr("id")+"_loader",l=a("#"+i),m=a("#"+j),n=a("#"+k);if(m.remove(),n.remove(),!l.get(0)){var o="<div style='display:none' id='"+i+"' ></div>";h.after(o),a("#"+i).html(h.html()),l=a("#"+i)}var p=function(){var b="";b=c.sortBy?c.sortBy.split(","):[];l.find("li").attr("data-eq","");var g="",i=[],m=[],n=[];if(b.length>0)for(var o=0;o<b.length;o++){var p=b[o];if(p.indexOf("|")>-1){for(var q=p.split("|"),r=p.replace("*","").split("=")[0],s=[],t="",u=0;u<q.length;u++){var v=q[u].replace("*","");s.push(v.replace(r+"=",""))}t=s.join("|"),p.indexOf("*")>-1?m.push(r+"*:"+t):m.push(r+":"+t)}else m.push(p.replace("=",":"))}else g=l.find("li");if(m.length>0)for(var w=0;w<m.length;w++){for(var x=m[w].split(":")[0],y=m[w].split(":")[1].split("|"),z=[],A=0;A<y.length;A++){var B=x+"="+y[A],C=l.find("li["+B+"]");if(C.length>0)for(var D=0;D<C.length;D++){var E=C[D],F=l.find("li").index(E);z.push(F)}}n.push(d(z))}for(var G in n){var H=n[G];i=0===parseInt(G,10)?H:e(i.sort(f),H.sort(f))}i.length>0&&(a.each(i,function(a,b){l.find("li").eq(b).attr("data-eq","push")}),g=l.find("li[data-eq=push]"));var I=function(b,d){if(!a(b).attr(c.sortAscTag)||!a(d).attr(c.sortAscTag))return-1;var e=isNaN(a(b).attr(c.sortAscTag))?0:a(b).attr(c.sortAscTag),f=isNaN(a(d).attr(c.sortAscTag))?0:a(d).attr(c.sortAscTag);return c.sortAscTag?"asc"===c.sortAscKey?parseInt(e,10)>parseInt(f,10)?-1:1:parseInt(e,10)>parseInt(f,10)?1:-1:void 0},J=h.find("ul");if(g.length>0){var K=g.clone();J.html(""),c.targetAjaxload?(h.after("<div id='"+k+"' >"+c.tragetAjaxText+"</div>"),setTimeout(function(){a("#"+k).remove(),J.html(K.sort(I))},600)):J.html(K.sort(I))}else J.html(""),a("#"+j).remove(),a("#"+k).remove(),c.targetAjaxload?(h.after("<div id='"+k+"' >"+c.tragetAjaxText+"</div>"),setTimeout(function(){a("#"+j).remove(),a("#"+k).remove(),h.after("<div id='"+j+"' >"+c.targetNull+"</div>")},500)):(a("#"+j).remove(),a("#"+k).remove(),h.after("<div id='"+j+"' >"+c.targetNull+"</div>"));c.targetAjaxload?setTimeout(function(){c.onCallback()},600):c.onCallback()};p(),c.onInit()})},a.fn.uzSorter.option={sortBy:"",sortAscTag:"",sortAscKey:"asc",targetNull:"没有找到相关产品，换个筛选条件再试试吧~",targetAjaxload:!0,tragetAjaxText:"数据载入中...",targetLazyload:!0,onInit:function(){},onCallback:function(){}}}(jQuery);